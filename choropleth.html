<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: Scaling the AlbersUSA projection</title>
		<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
		<style type="text/css">
			/* No style rules here yet */		
		</style>
	</head>
	<body>
		<script type="text/javascript">

			//Width and height
			var w = 1024;
			var h = 768;

			//Define path generator
			var projection = d3.geoStereographic()
				.translate([w-300, h-600])
				.scale([800]);

			var path = d3.geoPath()
				.projection(projection);

			//Create SVG element
			var svg = d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);

			var cScale = d3.scaleLinear().domain([0,2600]).range(["#fee0d2","#fc9272","#de2d26"]);

			//Load in GeoJSON data
			d3.csv("Brazil_Epidemiological_Bulletin-2016-04-02.csv", function(data) {
				d3.json("brazil-states.json", function(json) { 
					for (var i = 0; i < data.length; i++) { 
						var dataState = data[i].location; 
						var dataValue = parseFloat(data[i].value);
						for (var j = 0; j < json.features.length; j++) { 
							var jsonState = json.features[j].properties.name; 
							console.log(json.features[j].properties.name + "/" + data[i].location);
							if (dataState == jsonState) { 
								json.features[j].properties.value = dataValue; 
								break; 
							} 
						} 
					}
				
				//Bind data and create one path per GeoJSON feature
				svg.selectAll("path")
				   .data(json.features)
				   .enter()
				   .append("path")
				   .attr("d", path)
				   .style("fill", function(d) {
				   		return cScale(d.properties.value);
				   	});
		})
				});
			
		</script>
	</body>
</html>
